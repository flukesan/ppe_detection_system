# PPE Detection System Configuration

application:
  name: "PPE Detection System"
  version: "1.0.0"
  debug: false

camera:
  default_id: 0
  width: 1280
  height: 720
  fps: 30
  auto_reconnect: true
  reconnect_delay: 5

# Multi-Camera Fusion Settings
multi_camera:
  enabled: false  # Enable multi-camera fusion mode
  num_cameras: 2  # Number of cameras for fusion
  display_mode: "fused"  # "fused" or "side_by_side"

  # Camera sources (can be int for USB, string for RTSP/file)
  camera_sources:
    - 0  # Camera 1: USB camera 0 (CamNB_0)
    - "rtsp://admin:wip50313@192.168.1.181:8554"  # Camera 2: RTSP camera
    # Examples for other sources:
    # - "rtsp://192.168.1.100:554/stream"
    # - "/path/to/video.mp4"

  # Individual camera configurations (optional, uses default if not specified)
  camera_configs:
    - width: 1280
      height: 720
      fps: 30
    - width: 1280
      height: 720
      fps: 15  # Lower FPS for RTSP to reduce bandwidth and errors

# Fusion Algorithm Settings
fusion:
  # Strategy for combining detections: "or", "and", "weighted"
  # - "or": Violation if either camera detects it (more sensitive)
  # - "and": Violation only if both cameras detect it (more strict)
  # - "weighted": Use match confidence for decision
  strategy: "or"

  # Person matching parameters
  spatial_weight: 0.6  # Weight for spatial proximity (0-1)
  appearance_weight: 0.4  # Weight for appearance similarity (0-1)
  max_distance_threshold: 0.5  # Maximum distance for matching (0-1)

detection:
  confidence_threshold: 0.5
  nms_threshold: 0.4
  use_gpu: true
  gpu_device: 0
  frame_skip: 0

  # PPE Classes to detect
  ppe_classes:
    - helmet
    - vest
    - gloves
    - boots
    - goggles
    - mask

  # Required PPE (all must be detected)
  required_ppe:
    - helmet
    - vest

  # Detection zones (polygon-based filtering)
  # Only persons inside defined zones will be detected
  # If no zones are defined, detection works everywhere
  zones_file: "data/detection_zones.json"  # Path to zones file

tracking:
  max_age: 30
  min_hits: 3
  iou_threshold: 0.3
  max_distance: 0.5

temporal_filter:
  buffer_size: 30
  violation_threshold: 0.7

models:
  yolov8_pose:
    path: "yolov8m-pose.pt"  # Auto-downloaded by Ultralytics (n/s/m/l/x)
    input_size: 640
    device: "auto"  # Auto-select GPU if available, otherwise CPU

  ppe_detection:
    path: "models/ppe_detection_best.pt"  # Must be trained separately
    input_size: 640
    device: "auto"  # Auto-select GPU if available, otherwise CPU

database:
  path: "data/database/ppe_detections.db"
  backup_enabled: true
  backup_interval: 86400  # seconds (24 hours)

logging:
  level: "INFO"
  path: "data/logs/app.log"
  max_size: 10485760  # 10MB
  backup_count: 5
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

video_recording:
  enabled: true
  record_violations_only: true
  save_path: "data/videos/"
  codec: "mp4v"
  quality: 80
  max_duration: 300  # seconds
  pre_buffer: 5  # seconds before violation
  post_buffer: 5  # seconds after violation

screenshots:
  enabled: true
  save_path: "data/screenshots/"
  format: "jpg"
  quality: 90

alerts:
  enabled: true
  sound: true
  email: false
  line_notify: false

  # Cooldown between same type alerts (seconds)
  cooldown: 60

  email:
    smtp_server: "smtp.gmail.com"
    smtp_port: 587
    use_tls: true
    username: ""
    password: ""
    recipients: []

  line_notify:
    token: ""

ui:
  window:
    width: 1920
    height: 1080
    resizable: true

  theme: "dark"
  language: "th"

  display:
    show_fps: true
    show_confidence: true
    show_pose_keypoints: true
    show_tracking_id: true
    show_violation_count: true

  colors:
    safe: [0, 255, 0]  # Green
    violation: [0, 0, 255]  # Red
    warning: [0, 165, 255]  # Orange

statistics:
  update_interval: 1.0  # seconds
  chart_history: 3600  # seconds (1 hour)
  export_format: "xlsx"

performance:
  max_threads: 4
  queue_size: 10
  memory_limit: 4096  # MB

notifications:
  max_queue_size: 100
  display_duration: 5000  # milliseconds
